<div class="p-6 max-w-7xl mx-auto animate-[fadeIn_0.5s]">

    <div class="flex justify-between items-center mb-8">
        <div>
            <h1 class="text-3xl font-serif-title font-bold text-[var(--lumiere-bordeaux)]">
                Auditoria de Stock
            </h1>
            <p class="text-gray-500 mt-1 text-sm">Hist√≥rico de entradas, sa√≠das e quebras de material.</p>
        </div>

        <div class="bg-white px-4 py-2 rounded-lg border border-gray-100 shadow-sm text-xs font-bold text-gray-500 uppercase tracking-wider">
            Registos: {{ movements().length }}
        </div>
    </div>

    <div class="bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden">

        @if (isLoading()) {
        <div class="p-12 text-center text-gray-400">
            <div class="w-8 h-8 border-4 border-gray-200 border-t-[var(--lumiere-bordeaux)] rounded-full animate-spin mx-auto mb-4"></div>
            <p class="text-xs font-medium">A carregar hist√≥rico...</p>
        </div>
        }

        @else {
        <table class="w-full text-sm text-left">
            <thead class="bg-gray-50 text-gray-500 font-bold uppercase text-[10px] tracking-wider border-b border-gray-100">
            <tr>
                <th class="p-4">Data</th>
                <th class="p-4">Material</th>
                <th class="p-4">Tipo</th>
                <th class="p-4 text-right">Quantidade</th>
                <th class="p-4">Motivo / Ref</th>
                <th class="p-4 text-right">Utilizador</th>
            </tr>
            </thead>
            <tbody class="divide-y divide-gray-50">
            @for (mov of movements(); track mov.id) {
            <tr class="hover:bg-gray-50 transition-colors group">

                <td class="p-4 text-gray-500 whitespace-nowrap font-mono text-xs">
                    {{ mov.timestamp | date:'dd/MM/yyyy HH:mm' }}
                </td>

                <td class="p-4 font-bold text-gray-700">
                    {{ mov.materialName }}
                </td>

                <td class="p-4">
                    @switch (mov.type) {
                    @case ('INBOUND') {
                    <span class="px-2 py-1 rounded text-[10px] font-bold border bg-green-50 text-green-700 border-green-200 inline-flex items-center gap-1">
                                            üì• Entrada
                                        </span>
                    }
                    @case ('OUTBOUND') {
                    <span class="px-2 py-1 rounded text-[10px] font-bold border bg-red-50 text-red-700 border-red-200 inline-flex items-center gap-1">
                                            üì§ Sa√≠da
                                        </span>
                    }
                    @case ('ADJUSTMENT') {
                    <span class="px-2 py-1 rounded text-[10px] font-bold border bg-orange-50 text-orange-700 border-orange-200 inline-flex items-center gap-1">
                                            ‚ö†Ô∏è Ajuste
                                        </span>
                    }
                    @case ('RETURN') {
                    <span class="px-2 py-1 rounded text-[10px] font-bold border bg-blue-50 text-blue-700 border-blue-200 inline-flex items-center gap-1">
                                            üîÑ Devolu√ß√£o
                                        </span>
                    }
                    }
                </td>

                <td class="p-4 text-right font-mono font-bold text-sm">
                                <span [ngClass]="{
                                    'text-green-600': mov.quantity > 0,
                                    'text-red-500': mov.quantity < 0,
                                    'text-gray-400': mov.quantity === 0
                                }">
                                    {{ mov.quantity > 0 ? '+' : '' }}{{ mov.quantity }}
                                </span>
                </td>

                <td class="p-4 text-gray-600 text-xs italic">
                    {{ mov.notes || '-' }}
                </td>

                <td class="p-4 text-right text-[10px] text-gray-400 uppercase tracking-wide">
                    {{ mov.userName || 'SYSTEM' }}
                </td>
            </tr>
            } @empty {
            <tr>
                <td colspan="6" class="p-12 text-center text-gray-400">
                    <i data-feather="archive" class="w-8 h-8 mx-auto mb-2 opacity-50"></i>
                    <p>Ainda n√£o existem movimentos de stock registados.</p>
                </td>
            </tr>
            }
            </tbody>
        </table>
        }
    </div>
</div>
